---
output: html_document
---

```{r}
# PAQUETES NECESARIOS
require(glue)

# FUNCIONES NECESARIAS
source("RECURSOS-INVESTIGACION/R/get-dat-basic.R")
source("RECURSOS-INVESTIGACION/R/get-dat-group.R")
source("RECURSOS-INVESTIGACION/R/def-mod-entidades.R")
source("RECURSOS-INVESTIGACION/R/render-table-basic.R")
source("RECURSOS-INVESTIGACION/R/handles.R")

# VARIABLES GLOBALES DEL DOCUMENTO
dat <- getDatEEFF()
entidadesCompModelo <- getEntidadesCompModelo(dat)
datGroupBySector <- getDatEEFFByGroup(dat,by = 'TIPO_DE_ENTIDAD' )
```

## Precisiones del diagnostico financiero presentado

En la presente sección se presentaran las características a la cuales están sujetas el diagnostico presentado en este capítulo.

### Entidades financieras comprendidas por el diagnostico

El numero de observaciones de la datos manejados por esta investigación alcanzan a `r nrow(dat)`, donde cada observación corresponde a un balance general y un estado de resultados en un punto del tiempo entre las fechas (`r min(dat$FECHA)` - `r max(dat$FECHA)`), dichos estados financieros se clasifican o agrupara por sectores financieros los cuales son:

- Bancos múltiples
- Bancos PYME.
- Bancos de desarrollo productivo.
- Instituciones financieras de desarrollo.
- Entidades financieras de vivienda.
- Cooperativas.

Una vez agrupados los datos por sectores los datos dan un total de `r nrow(datGroupBySector)` observaciones.

#### Bancos múltiples

```{r}
idTipoEntidad <- 'BANCOS_MULTIPLES'
entidadesModelo <- entidadesCompModelo[entidadesCompModelo$TIPO_DE_ENTIDAD==idTipoEntidad,
                                       c('SIGLA','ENTIDAD','DE','HASTA')]
```

El sector de `r tolower(gsub('_',' ',idTipoEntidad))` representan `r sum(datGroupBySector$TIPO_DE_ENTIDAD==idTipoEntidad)` observaciones del total de los datos agrupados, dicho sector esta comprendido por `r nrow(entidadesModelo)` entidades, que se presentan a continuación:


```{r}
captionTable <- glue('{handle$toUpperFirstText(gsub("_"," ",idTipoEntidad))} contenidas en los datos')
renderTableBasic(entidadesModelo,captionTable = captionTable)
```


#### Bancos PYME

```{r}
idTipoEntidad <- 'BANCOS_PYME'
entidadesModelo <- entidadesCompModelo[entidadesCompModelo$TIPO_DE_ENTIDAD==idTipoEntidad,
                                       c('SIGLA','ENTIDAD','DE','HASTA')]
```

El sector de `r gsub('pyme','PYME',tolower(gsub('_',' ',idTipoEntidad)))` representan `r sum(datGroupBySector$TIPO_DE_ENTIDAD==idTipoEntidad)` observaciones del total de los datos agrupados, dicho sector esta comprendido por `r nrow(entidadesModelo)` entidades, que se presentan a continuación:


```{r}
captionTable <- glue('{gsub("pyme","PYME",handle$toUpperFirstText(gsub("_"," ",idTipoEntidad)))} contenidos en los datos')
renderTableBasic(entidadesModelo,captionTable = captionTable)
```


#### Bancos de desarrollo productivo

```{r}
idTipoEntidad <- 'BANCOS_DE_DESARROLLO_PRODUCTIVO'
entidadesModelo <- entidadesCompModelo[entidadesCompModelo$TIPO_DE_ENTIDAD==idTipoEntidad,
                                       c('SIGLA','ENTIDAD','DE','HASTA')]
```

El sector de `r tolower(gsub('_',' ',idTipoEntidad))` representan `r sum(datGroupBySector$TIPO_DE_ENTIDAD==idTipoEntidad)` observaciones del total de los datos agrupados, dicho sector esta comprendido por `r nrow(entidadesModelo)` entidades, que se presentan a continuación:


```{r}
captionTable <- glue('{handle$toUpperFirstText(gsub("_"," ",idTipoEntidad))} contenidas en los datos')
renderTableBasic(entidadesModelo,captionTable = captionTable)
```


#### Instituciones financieras de desarrollo

```{r}
idTipoEntidad <- 'INSTITUCIONES_FINANCIERAS_DE_DESARROLLO'
entidadesModelo <- entidadesCompModelo[entidadesCompModelo$TIPO_DE_ENTIDAD==idTipoEntidad,
                                       c('SIGLA','ENTIDAD','DE','HASTA')]
```

El sector de `r tolower(gsub('_',' ',idTipoEntidad))` representan `r sum(datGroupBySector$TIPO_DE_ENTIDAD==idTipoEntidad)` observaciones del total de los datos agrupados, dicho sector esta comprendido por `r nrow(entidadesModelo)` entidades, que se presentan a continuación:


```{r}
captionTable <- glue('{handle$toUpperFirstText(gsub("_"," ",idTipoEntidad))} contenidas en los datos')
renderTableBasic(entidadesModelo,captionTable = captionTable)
```

#### Entidades financieras de vivienda

```{r}
idTipoEntidad <- 'ENTIDADES_FINANCIERAS_DE_VIVIENDA'
entidadesModelo <- entidadesCompModelo[entidadesCompModelo$TIPO_DE_ENTIDAD==idTipoEntidad,
                                       c('SIGLA','ENTIDAD','DE','HASTA')]
```

El sector de `r tolower(gsub('_',' ',idTipoEntidad))` representan `r sum(datGroupBySector$TIPO_DE_ENTIDAD==idTipoEntidad)` observaciones del total de los datos agrupados, dicho sector esta comprendido por `r nrow(entidadesModelo)` entidades, que se presentan a continuación:


```{r}
captionTable <- glue('{handle$toUpperFirstText(gsub("_"," ",idTipoEntidad))} contenidas en los datos')
renderTableBasic(entidadesModelo,captionTable = captionTable)
```

#### Cooperativas

```{r}
idTipoEntidad <- 'COOPERATIVAS_DE_AHORRO_Y_CREDITO'
entidadesModelo <- entidadesCompModelo[entidadesCompModelo$TIPO_DE_ENTIDAD==idTipoEntidad,
                                       c('SIGLA','ENTIDAD','DE','HASTA')]
```

El sector de `r tolower(gsub('_',' ',idTipoEntidad))` representan `r sum(datGroupBySector$TIPO_DE_ENTIDAD==idTipoEntidad)` observaciones del total de los datos agrupados, dicho sector esta comprendido por `r nrow(entidadesModelo)` entidades, que se presentan a continuación:


```{r}
captionTable <- glue('{handle$toUpperFirstText(gsub("_"," ",idTipoEntidad))} contenidas en los datos')
renderTableBasic(entidadesModelo,captionTable = captionTable)
```

### Variables comprendidas en el diganostico

Las variables comprendidas en el modelo del diagnostico están sujetas al manual de cuentas para entidades financieras.

#### Activo

Según [@MANUAL_CUENTAS_ASFI] los activos (designado por el código 100.00 en el manual de cuentas) son aquellas que agrupan las cuentas representativas de bienes y derechos de la entidad, la cuales comprenden:

- Disponibilidades
- Inversiones temporarias
- Cartera
- Otras cuentas por cobrar
- Bienes realizables
- Inversiones permanentes
- Bienes de uso 
- Otros activos. 


#### Disponibles

Según [@MANUAL_CUENTAS_ASFI] los activos disponibles (designado por el código 110.00 en el manual de cuentas) representa el efectivo que mantiene la entidad en caja, los saldos a la vista en el Banco Central de Bolivia, en oficina matriz y sucursales del exterior, en bancos y corresponsales del país y del exterior; así como, la tenencia de metales preciosos. También representa la existencia de cheques, otros documentos mercantiles de cobro inmediato y órdenes electrónicas de pago pendientes de liquidación. 

#### Realizables

Según [@MANUAL_CUENTAS_ASFI] los activos realizables (designado por el código 150.00 en el manual de cuentas) representa los bienes tangibles de propiedad de la entidad con destino de venta como ser: 

- Los bienes adquiridos o construidos para la venta 
- Los bienes recibidos en recuperación de créditos o de operaciones de arrendamiento financiero
- Los bienes fuera de uso y otros bienes realizables

#### Inversiones temporarias

Según [@MANUAL_CUENTAS_ASFI] las inversiones temporarias (designado por el código 120.00 en el manual de cuentas) registran:

- Las inversiones en depósitos en otras “entidades de intermediación financiera” 
- Los depósitos en el Banco Central de Bolivia y los valores representativos de deuda adquiridos por la entidad
- Las inversiones que han sido realizadas, conforme a su política de inversiones, con la intención de obtener una adecuada rentabilidad de sus excedentes temporales de liquidez y que puedan ser convertidas en disponibilidades en un plazo no mayor a treinta (30) días.

#### Pasivos

Según [@MANUAL_CUENTAS_ASFI] los pasivos (designado por el código 200.00 en el manual de cuentas) se agrupan las cuentas representativas de las obligaciones directas de la entidad la que comprenden:

- Las obligaciones con el público, 
- Las obligaciones con instituciones fiscales,
- Las obligaciones con bancos y entidades de financiamiento, incluyendo las obligaciones
con el Banco Central de Bolivia y otros; 
- Los títulos valores en circulación emitidos por la entidad, 
- Las obligaciones subordinadas 
- Las obligaciones con empresas públicas 
- Las obligaciones diversas a cargo de la entidad 
- Las previsiones que no representan correcciones de valores del activo. 

#### Patrimonio

Según [@MANUAL_CUENTAS_ASFI] el patrimonio (designado por el código 300.00 en el manual de cuentas) representa la participación de los propietarios en el activo de la entidad. Su importe se determina por la diferencia entre el activo y el pasivo. 

#### Cartera en mora

(designado por el código 133.00 en el manual de cuentas) En esta cuenta se registran los créditos cuyo capital, cuotas de amortización o intereses no hayan sido cancelados íntegramente a la entidad hasta los 30 días contados desde la fecha de vencimiento. Para este efecto, la fecha efectiva de contabilización en esta cuenta es el día 31 de incumplimiento en cronograma de pagos.

(designado por el código 134.00 en el manual de cuentas) En esta cuenta se registran los créditos por los cuales la entidad ha iniciado las acciones judiciales para el cobro.

#### Cartera Bruta

Esta variable esta compuesta:

- Cartera vigente 
- Cartera vencida 
- Cartera en ejecución

La cartera vencida y en ejecución fueron descritas anteriormente sumando una cuenta, quedando la cartera vigente (designado por el código 131.00 en el manual de cuentas) En esta cuenta se registran los créditos que tienen sus amortizaciones de capital e intereses al día conforme al plan de pagos establecido en el contrato de crédito, y aquellos que se encuentran con un atraso en sus pagos de hasta 30 días, a partir de la fecha de incumplimiento del cronograma original de pagos.


#### Cartera reprogramada o restructurada total

(designado por el código 135.00 en el manual de cuentas) En esta cuenta se registran los créditos reprogramados o reestructurados que tienen sus amortizaciones de capital e intereses al día conforme al plan de pagos establecido en el contrato de reprogramación o reestructuración del crédito, y aquellos que se encuentran con un atraso en sus pagos de hasta 30 días a partir de la fecha de vencimiento. Las operaciones de crédito serán traspasadas a cartera reestructurada vigente una vez admitida la solicitud de apertura del procedimiento para la suscripción de un acuerdo de transacción e inscrita en el Registro de Comercio de la Autoridad de Fiscalización y Control Social de Empresas. Las subcuentas del 1 al 49 son utilizadas para el registro de reprogramaciones y del 51 al 99 para el registro de reestructuraciones.

(designado por el código 136.00 en el manual de cuentas) En esta cuenta se registran los créditos reprogramados o reestructurados cuyo capital, cuotas de amortización o intereses no hayan sido cancelados íntegramente a la entidad hasta los 30 días contados desde la fecha de vencimiento. Para este efecto, la fecha efectiva de contabilización en esta cuenta es el día 31 de incumplimiento en el cronograma de pagos.

(designado por el código 137.00 en el manual de cuentas) En esta cuenta se registran los créditos reprogramados o reestructurados por los cuales la entidad ha iniciado las acciones judiciales para el cobro. Las operaciones de crédito serán traspasadas a cartera reestructurada en ejecución una vez admitida la solicitud de apertura del procedimiento para la suscripción de un acuerdo de transacción e inscrita en el Registro de Comercio de la Autoridad de Fiscalización y Control Social de Empresas.

#### Previsión cartera

(designado por el código 139.00 en el manual de cuentas) En esta cuenta se registra el importe que se estima para cubrir los riesgos de pérdidas por incobrabilidad de préstamos, de acuerdo con lo dispuesto en el Libro 3°, Título II de la Recopilación de Normas para Servicios Financieros y en la descripción del grupo Cartera. 

#### Contingente

(designado por el código 600.00 en el manual de cuentas) Representa derechos eventuales que tendría la entidad contra el deudor principal en caso que éste no cumpla con las obligaciones sobre las cuales la entidad indirectamente asumió responsabilidad.Comprende operaciones por Cartas de crédito, Garantías otorgadas, Documentos descontados, Líneas de crédito comprometidas utilizables automáticamente y Otras
contingencias. 

(designado por el código 700.00 en el manual de cuentas) Representa las obligaciones eventuales que tendría la entidad por responsabilidades asumidas, si el deudor principal no cumple con las mismas. Comprende operaciones por cartas de crédito, garantías otorgadas, documentos descontados, líneas de crédito comprometidas y otras contingencias. 

#### Gastos administrativos

Según [@MANUAL_CUENTAS_ASFI] los gastos administrativos (designado por el código 450.00 en el manual de cuentas) representa los gastos devengados en el período incurridos para el desenvolvimiento administrativo de la entidad, que se resumen en:

- Comprende los gastos de personal (retribuciones, cargas sociales, servicios al personal, etc.)
- Servicios contratados a terceros (computación, seguridad, etc.)
- Seguros, comunicaciones y traslados
- Impuestos
- Mantenimiento y reparaciones
- Depreciación de bienes de uso
- Amortización de cargos diferidos y activos intangibles
- Otros gastos de administración (gastos notariales y judiciales, alquileres, energía eléctrica, agua y calefacción, papelería, útiles y materiales de servicio, etc.) 


#### Impuestos

En esta cuenta se (designado por el código 455.00 en el manual de cuentas) registran los gastos devengados en el período por concepto de impuestos, asimismo los intereses y recargos originados por los mismos. El gasto por Impuesto al valor agregado que se registra en esta cuenta, es el que surge de aplicar la tasa del impuesto sobre ingresos presuntos, tales como el que proviene de tomar en anticrético un bien. 

(designado por el código 460.00 en el manual de cuentas) Comprende los gastos devengados en el período por concepto de impuesto sobre las utilidades de las empresas. 


#### Resultado operativo bruto

- Ingresos financieros
- (-) Gastos financieros
- (+) Otros ingresos operativos
- (-) Otros gastos operativos

#### Resultado neto de la gestión

- Ingresos financieros
- (-) Gastos financieros
- (+) Otros ingresos operativos
- (-) Otros gastos operativos
- (+/-) Gastos (Ingresos) extraordinarios 
- (-) Impuestos


